import{l as S,r as x,a as q,d as z,u as I,c as N,b as m,e as R,f as o,w as r,g as a,h as n,o as C,I as D,m as E,i as v,j as f,M as w,E as L,_ as Y}from"./index-0k8HkCPh.js";function V(){const l=S().format("YYYY-MM-DD HH:mm:ss");return console.warn("ç”Ÿæˆæ—¶é—´:",l),l}function j(){const l=Math.floor(1e6+Math.random()*9e6);return console.warn("ç”Ÿæˆçš„7ä½éšæœºæ•°ä¸º:",l),l}function B(){const l=x(!1),d=q({username:"",email:"",password:"",confirmPassword:"",agree:!1});return{loading:l,rules:{username:[{required:!0,message:"è¯·è¾“å…¥ç”¨æˆ·å"},{minLength:2,message:"ç”¨æˆ·åé•¿åº¦ä¸èƒ½å°‘äº2ä½"},{maxLength:20,message:"ç”¨æˆ·åé•¿åº¦ä¸èƒ½è¶…è¿‡20ä½"}],email:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±åœ°å€"},{type:"email",message:"è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±æ ¼å¼"}],password:[{required:!0,message:"è¯·è¾“å…¥å¯†ç "},{minLength:6,message:"å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½"}],confirmPassword:[{required:!0,message:"è¯·ç¡®è®¤å¯†ç "},{validator:(g,i)=>{g!==d.password?i("ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´"):i()}}]},form:d}}const F={class:"register-container"},G={class:"register-card"},H={class:"agreement"},T={class:"login-link"},Q=z({__name:"Register",setup(l){const{loading:d,form:s,rules:g}=B(),i=x(),y=I();async function k({errors:c}){if(c){console.error("æ³¨å†Œè¡¨å•error:",c);return}if(!s.agree){w.warning("è¯·å…ˆåŒæ„ç”¨æˆ·åè®®å’Œéšç§æ”¿ç­–");return}d.value=!0;try{console.warn("æ³¨å†Œä¿¡æ¯:",s);const e={id:j(),username:s.username,email:s.email,password_hash:L(s.password),role:"user",status:1,created_at:V(),updated_at:V()},u=y.registerUser(e);console.warn("æ³¨å†Œç»“æœ:",u),u?w.success("æ³¨å†ŒæˆåŠŸ"):(i.value?.setFields({email:{status:"error",message:"è¯¥é‚®ç®±å·²è¢«æ³¨å†Œ"}}),console.error("æ³¨å†Œå¤±è´¥"))}catch(e){console.error(e),w.error("æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}finally{d.value=!1}}return(c,e)=>{const u=n("a-input"),p=n("a-form-item"),b=n("a-input-password"),U=n("a-checkbox"),_=n("a-link"),M=n("a-button"),P=n("a-form");return C(),N("div",F,[m("div",G,[e[12]||(e[12]=R('<div class="logo-section" data-v-d93fbdf5><div class="logo" data-v-d93fbdf5><span class="logo-icon" data-v-d93fbdf5>ğŸŠ</span><span class="logo-text" data-v-d93fbdf5>å°æ©˜é—®å·</span></div><p class="subtitle" style="color:#ff7a00;font-weight:800;" data-v-d93fbdf5> Xiaoju Questionnaire </p><p class="subtitle" style="margin-top:1vh;" data-v-d93fbdf5> åˆ›å»ºæ‚¨çš„è´¦å· </p></div>',1)),o(P,{ref_key:"registerFormRef",ref:i,model:a(s),rules:a(g),layout:"vertical",class:"register-form",onSubmit:k},{default:r(()=>[o(p,{field:"username",label:"ç”¨æˆ·å"},{default:r(()=>[o(u,{modelValue:a(s).username,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).username=t),placeholder:"è¯·è¾“å…¥ç”¨æˆ·å",size:"large",prefix:a(D)},null,8,["modelValue","prefix"])]),_:1}),o(p,{field:"email",label:"é‚®ç®±"},{default:r(()=>[o(u,{modelValue:a(s).email,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).email=t),placeholder:"è¯·è¾“å…¥é‚®ç®±åœ°å€",size:"large",prefix:a(E)},null,8,["modelValue","prefix"])]),_:1}),o(p,{field:"password",label:"å¯†ç "},{default:r(()=>[o(b,{modelValue:a(s).password,"onUpdate:modelValue":e[2]||(e[2]=t=>a(s).password=t),placeholder:"è¯·è¾“å…¥å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰",size:"large",prefix:a(v)},null,8,["modelValue","prefix"])]),_:1}),o(p,{field:"confirmPassword",label:"ç¡®è®¤å¯†ç "},{default:r(()=>[o(b,{modelValue:a(s).confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=t=>a(s).confirmPassword=t),placeholder:"è¯·å†æ¬¡è¾“å…¥å¯†ç ",size:"large",prefix:a(v)},null,8,["modelValue","prefix"])]),_:1}),m("div",H,[o(U,{modelValue:a(s).agree,"onUpdate:modelValue":e[4]||(e[4]=t=>a(s).agree=t)},{default:r(()=>[...e[5]||(e[5]=[f(" æˆ‘å·²é˜…è¯»å¹¶åŒæ„ ",-1)])]),_:1},8,["modelValue"]),o(_,{class:"agreement-link"},{default:r(()=>[...e[6]||(e[6]=[f(" ã€Šç”¨æˆ·åè®®ã€‹ ",-1)])]),_:1}),e[8]||(e[8]=m("span",null,"å’Œ",-1)),o(_,{class:"agreement-link"},{default:r(()=>[...e[7]||(e[7]=[f(" ã€Šéšç§æ”¿ç­–ã€‹ ",-1)])]),_:1})]),o(M,{type:"primary","html-type":"submit",size:"large",class:"register-button",loading:a(d),disabled:!a(s).agree,long:""},{default:r(()=>[...e[9]||(e[9]=[f(" æ³¨å†Œ ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["model","rules"]),m("div",T,[e[11]||(e[11]=m("span",null,"å·²æœ‰è´¦å·ï¼Ÿ",-1)),o(_,{href:"/login",class:"login-text"},{default:r(()=>[...e[10]||(e[10]=[f(" ç«‹å³ç™»å½• ",-1)])]),_:1})])])])}}}),h=Y(Q,[["__scopeId","data-v-d93fbdf5"]]);export{h as default};
